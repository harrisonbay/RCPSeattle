var crimeColorScale=d3.scaleQuantize(),incomeColorScale=d3.scaleQuantize(),crimeData,incomeData,crimeColorMapping,incomeColorMapping;let censusTractsGeoJSON;var areaName;const dboardWidth=2e3,dboardHeight=1e3,dboardX=1e3,dboardY=500;var dashboard=d3.select("#dashboard").append("svg").attr("viewBox",[1e3,500,2e3,1e3]).attr("class","dashSvg").style("overflow","visible").style("display","block").style("z-index","3");dashboard.append("text").attr("class","areaLabel").attr("x",1800).attr("y",1072.5).attr("text-anchor","middle").style("font-size","32px").style("font-weight","bold");const tractsWidth=700,tractsHeight=900,tractsMargin=50,tractsX=1050,tractsY=550;var tractMap=dashboard.append("svg").attr("width",700).attr("height",900).attr("x",1050).attr("y",550).style("z-index","3"),mapLegend=tractMap.append("g").style("z-index","5"),crimeLegend,incomeLegend;const pieWidth=500,pieHeight=300,pieRadius=Math.min(500,300)/2.7,pieX=1630,pieY=1130;var pieChart=dashboard.append("svg").attr("width",500).attr("height",300).attr("x",1630).attr("y",1130);const fancyWidth=300,fancyHeight=900,fancyX=2080,fancyY=580;var fancyBarChart=dashboard.append("svg").attr("width",300).attr("height",900).attr("x",2080).attr("y",580);const plotMargin={top:10,right:30,bottom:150,left:60},plotWidth=400-plotMargin.left-plotMargin.right,plotHeight=400-plotMargin.top-plotMargin.bottom,plotX=1630,plotY=600;var plotG=dashboard.append("svg").attr("width",plotWidth+plotMargin.left+plotMargin.right).attr("height",plotHeight+plotMargin.top+plotMargin.bottom).attr("x",1630).attr("y",600).append("g").attr("transform","translate("+plotMargin.left+","+plotMargin.top+")"),tractToIncome;d3.csv("./data/final_data/AggIncomeData.csv").then(data=>{incomeData=data,d3.csv("./data/final_data/AggCrimeData.csv").then(data2=>{crimeColorMapping=createMapping(crimeData=data2,"Count"),crimeColorScale.domain([0,crimeColorMapping.size-1]),crimeColorScale.range(d3.schemePurples[5]),incomeColorMapping=createMapping(incomeData,"Median Income"),incomeColorScale.domain([0,incomeColorMapping.size-1]),incomeColorScale.range(d3.schemeBlues[5]),crimeLegend=makeChoroplethLegend(crimeColorScale,"Number of Crimes"),incomeLegend=makeChoroplethLegend(incomeColorScale,"Median Income"),tractToIncome=new Map;for(let i=0;i<incomeData.length;i++)tractToIncome.set(parseInt(incomeData[i].Tract),parseInt(incomeData[i]["Median Income"]));tractToRacePercentages=new Map;for(let i=0;i<incomeData.length;i++){let value=[incomeData[i]["Percent White"],incomeData[i]["Percent Black"],incomeData[i]["Percent Indigenous"],incomeData[i]["Percent Asian"],incomeData[i]["Percent Islander"],incomeData[i]["Percent Other"],incomeData[i]["Percent Latino"]];var total=0;for(let j=0;j<value.length;j++)total+=parseFloat(value[j]);if(total<100){var missing=100-total;value.push(missing)}let key=parseInt(incomeData[i].Tract);tractToRacePercentages.set(key,value)}d3.json("./data/final_data/Census_Tracts_2010_TopoJSON.json").then(tracts=>{censusTractsGeoJSON=topojson.feature(tracts,tracts.objects.Census_Tracts_2010),drawMap(censusTractsGeoJSON,"Total Crime"),createPieLegend(),drawPlot(),updateAuxiliaryCharts(void 0),dashboard.selectAll("text").style("font-family","TiemposText-Regular")}).catch(error=>console.log(error))}).catch(error=>console.log(error))}).catch(error=>console.log(error));var stripePattern=dashboard.append("pattern").attr("id","pattern-stripe").attr("patternUnits","userSpaceOnUse").attr("width","20.5").attr("height","20.5").attr("patternTransform","rotate(45)");stripePattern.append("line").attr("x1","0").attr("y1","0").attr("x2","0").attr("y2","20.5").attr("stroke","#d3d3d3").attr("stroke-width","21");var projection=d3.geoMercator(),path=d3.geoPath().projection(projection);d3.selectAll("input").on("change",(function change(){drawMap(censusTractsGeoJSON)}));const choices=["Total Crime","Median Income"],choicesColor=["DarkOrchid","DodgerBlue"];var toggler=tractMap.selectAll(".text-toggler").data(choices).enter().append("g").attr("class","text-toggler").attr("id",d=>d).append("text").attr("x",(d,i)=>220+135*i).attr("y",15).text(d=>"Total Crime"==d?`> ${d}`:d).style("fill",(d,i)=>choicesColor[i]).style("opacity",d=>"Total Crime"==d?1:.5).attr("font-weight",d=>"Total Crime"==d?"bold":"normal").attr("text-decoration",d=>"Total Crime"==d?"underline":"none");function makeChoroplethLegend(colorScale,legendTitle){const legendSvg=tractMap.append("g").attr("transform","translate(10, 70)").attr("class","choropleth-legend");let legendCreator=d3.legendColor().title(legendTitle).shape("circle").shapePadding(5).shapeRadius(6).orient("vertical").labels((function({i:i,domain:domain,range:range}){let max,bins,intervalSize=domain[1]/range.length;if(colorScale==crimeColorScale){let tractNumOne,tractNumTwo;for(let[key,value]of crimeColorMapping.entries())if(value===Math.ceil(intervalSize*i)&&(tractNumOne=key),value==Math.ceil(intervalSize*(i+1))&&(tractNumTwo=key),tractNumOne&&tractNumTwo)break;let tractOne=crimeData.filter((function(x){return x.Tract==tractNumOne})),tractTwo=crimeData.filter((function(x){return x.Tract==tractNumTwo})),valueOne=0,valueTwo=0;for(let i=0;i<tractOne.length;i++)valueOne+=parseInt(tractOne[i].Count);for(let i=0;i<tractTwo.length;i++)valueTwo+=parseInt(tractTwo[i].Count);return numberWithCommas(valueOne)+" - "+numberWithCommas(valueTwo)}{let tractNumOne,tractNumTwo;for(let[key,value]of incomeColorMapping.entries())if(value===Math.ceil(intervalSize*i)&&(tractNumOne=key),value==Math.ceil(intervalSize*(i+1))&&(tractNumTwo=key),tractNumOne&&tractNumTwo)break;let tractOne=incomeData.filter((function(x){return x.Tract==tractNumOne})),tractTwo=incomeData.filter((function(x){return x.Tract==tractNumTwo})),valueOne=0,valueTwo=0;for(let i=0;i<tractOne.length;i++)valueOne+=parseInt(tractOne[i]["Median Income"]);for(let i=0;i<tractTwo.length;i++)valueTwo+=parseInt(tractTwo[i]["Median Income"]);return"$"+numberWithCommas(valueOne)+" - $"+numberWithCommas(valueTwo)}})).cellFilter((function(d){return"e"!==d.label})).scale(colorScale);return legendSvg.style("font-size","14px").call(legendCreator),legendSvg}function drawMap(tracts,filter){projection.fitExtent([[50,50],[650,850]],tracts),tractMap.selectAll("path").data(tracts.features,(function(d){return d.properties.TRACT})).join((function(enter){enter.append("path").attr("d",path).attr("id",d=>d.properties.TRACT).style("stroke","#A9A9A9").style("stroke-width","1").style("fill",(function(d){return"Income"==filter?incomeColorMapping.get(d.properties.TRACT)?incomeColorScale(incomeColorMapping.get(d.properties.TRACT)):"url(#pattern-stripe)":crimeColorScale(crimeColorMapping.get(d.properties.TRACT))})).on("mousemove",(function(event,d){d3.select(this).raise().style("stroke","#fff").style("stroke-width",2)})).on("mouseleave",(function(event,d){selected&&currentSelectedTract==d.properties.TRACT?d3.select(currentSelectedRef).raise().style("stroke","#d5ab09").style("stroke-width",3):selected&&currentSelectedTract!=d.properties.TRACT?(d3.select(this).raise().style("stroke","#A9A9A9").style("stroke-width",1),d3.select(currentSelectedRef).raise().style("stroke","#d5ab09").style("stroke-width",3)):d3.select(this).raise().style("stroke","#A9A9A9").style("stroke-width",1)})).on("click",(function(event,d){26001!=d.properties.TRACT&&(selected&&currentSelectedTract==d.properties.TRACT?(selected=!1,d3.select(this).raise().style("stroke","#FFF").style("stroke-width",2),currentSelectedRef=void 0,currentSelectedTract=0,updateAuxiliaryCharts(void 0)):(selected&&currentSelectedTract!=d.properties.TRACT&&d3.select(currentSelectedRef).raise().style("stroke","#A9A9A9").style("stroke-width",1),selected=!0,currentSelectedRef=this,currentSelectedTract=d.properties.TRACT,d3.select(this).raise().style("stroke","#d5ab09").style("stroke-width",3),updateAuxiliaryCharts(d)))}))}),(function(change){change.transition().style("fill",(function(d){return"Median Income"==filter?null==incomeColorMapping.get(d.properties.TRACT)?"url(#pattern-stripe)":incomeColorScale(incomeColorMapping.get(d.properties.TRACT)):crimeColorScale(crimeColorMapping.get(d.properties.TRACT))}))})),tractMap.selectAll(".choropleth-legend").classed("hidden",!0),"Median Income"==filter?(incomeLegend.classed("hidden",!1),crimeLegend.classed("hidden",!0)):(incomeLegend.classed("hidden",!0),crimeLegend.classed("hidden",!1))}toggler.on("click",(function(event,d){toggler.text(datum=>datum==d?`> ${datum}`:datum).style("opacity",datum=>datum==d?1:.5).attr("font-weight",datum=>datum==d?"bold":"normal").attr("text-decoration",datum=>datum==d?"underline":"none"),drawMap(censusTractsGeoJSON,d)}));var selected=!1,currentSelectedTract=0,currentSelectedRef=void 0;function updateAuxiliaryCharts(d){let tractnum,incomeText;void 0===d?(tractnum=0,areaName="City of Seattle"):(tractnum=d.properties.TRACT,areaName=d.properties.NAMELSAD10),income=tractToIncome.get(tractnum),incomeText=-1==income?"Ovr. Med. Income: N/A":"Ovr. Med. Income: $"+numberWithCommas(tractToIncome.get(tractnum)),plotG.select(".medianIncome").text(incomeText),drawFancyBarThing(tractnum),dashboard.selectAll(".areaLabel").text(areaName),makeFancyBarLegend(),createPieChart(tractnum),plotG.selectAll(".dot").sort((function(a,b){return a.t==tractnum&&b.t==tractnum||a.t!=tractnum&&b.t!=tractnum?0:a.t==tractnum&&b.t!=tractnum?1:-1})).transition().attr("r",3).style("opacity",.1).filter((function(s){return s.t==tractnum})).attr("r",8).style("opacity",1),plotG.selectAll(".dot").filter((function(s){return s.t==tractnum})).on("mousemove",(function(event,d){d3.select("#plotTooltip").style("left",event.clientX+20+"px").style("top",event.clientY-28+"px").select("#TractNumber").text(`${tooltipTitle(d.t)}`),d3.select("#plotTooltip").select("#value").text(`$${numberWithCommas(d.y)}`),d3.select("#plotTooltip").classed("hidden",!1),d3.select(this).raise().style("stroke","#d5ab09").style("stroke-width",4)})).on("mouseleave",(function(event,d){d3.select("#plotTooltip").classed("hidden",!0),d3.select(this).raise().style("stroke",null)})),plotG.selectAll(".dot").filter((function(s){return s.t!=tractnum})).on("mousemove",null).on("mouseleave",null)}var fancyBar=fancyBarChart.append("g").attr("transform","translate(50,40)"),fancyXScale=d3.scaleBand().range([0,150]).padding(.4),fancyYScale=d3.scaleLinear().range([700,0]),fancyXAxis=fancyBar.append("g").attr("transform","translate(0,700)"),fancyYAxis=fancyBar.append("g").attr("class","myYaxis"),barText=fancyBar.append("text").attr("class","myLabel"),fancyLegend=fancyBar.append("g"),fancyLegendG=fancyLegend.append("g").attr("class","legendThreshold").attr("transform","translate(135,90)");function getMaxForFancyBarThing(){for(var max=0,i=0;i<incomeData.length;i++){obj=incomeData[i],tractNum=obj.Tract;for(var crimeForTract=crimeData.filter(y=>y.Tract==tractNum),sum=0,j=0;j<crimeForTract.length;j++)sum+=parseInt(crimeForTract[j].Count);sum>max&&(max=sum)}return max}var colors=["#575757","#B7B7B7","#DEDEDE"],crimeTypes=["PROPERTY","PERSON","SOCIETY"];function makeFancyBarLegend(){var ordinal=d3.scaleOrdinal().domain(crimeTypes).range(colors),legendOrdinal=d3.legendColor().title("Type of Crime").shape("path",d3.symbol().type(d3.symbolCircle).size(200)()).shapePadding(10).cellFilter((function(d){return"e"!==d.label})).scale(ordinal);fancyLegend.select(".legendThreshold").style("font-family","TiemposText-Regular").style("font-size","16px").call(legendOrdinal)}function drawFancyBarThing(tractNum){var crimeForTract=crimeData.filter(y=>y.Tract==tractNum);crimeForTract.sort((function(a,b){return"PROPERTY"==a["Crime Against"]?-1:"SOCIETY"==a["Crime Against"]?0:1})),sum=0;for(var i=0;i<3;i++)sum+=parseInt(crimeForTract[i].Count);var offsetHeight=700;fancyXScale.domain(["Recorded Crimes"]),0==tractNum?fancyYScale.domain([0,45e4]).nice():fancyYScale.domain([0,30310]).nice(),fancyXAxis.call(d3.axisBottom(fancyXScale)),fancyYAxis.transition().call(d3.axisLeft(fancyYScale));var textHeight=Number.MAX_VALUE,total=0;fancyBar.selectAll("rect").data(crimeForTract,(function(d){return d["Crime Against"]})).join((function(enter){enter.append("rect").attr("class","fancyBar").attr("x",fancyXScale("Recorded Crimes")).attr("width",fancyXScale.bandwidth()).attr("y",(function(d){let ret=barPosition(crimeForTract,700,d);return textHeight>ret&&(textHeight=ret),total+=parseInt(d.Count),ret})).attr("height",(function(d){return 700-fancyYScale(parseInt(d.Count))})).attr("fill",(function(d){return colors[crimeTypes.indexOf(d["Crime Against"])]}))}),(function(update){update.transition().attr("y",(function(d){let ret=barPosition(crimeForTract,700,d);return textHeight>ret&&(textHeight=ret),total+=parseInt(d.Count),ret})).attr("height",(function(d){return 700-fancyYScale(parseInt(d.Count))}))}),(function(exit){exit.transition().remove()})),fancyBar.selectAll("rect").on("mousemove",(function(event,d){d3.select(this).raise().style("stroke","#d5ab09").style("stroke-width",4),d3.select("#stackedBarTooltip").style("left",event.clientX+20+"px").style("top",event.clientY-28+"px").classed("hidden",!1),d3.select("#stackedBarTooltip").select("#value").text(`${numberWithCommas(d.Count)}`)})).on("mouseleave",(function(event,d){d3.select(this).raise().style("stroke",null),d3.select("#stackedBarTooltip").classed("hidden",!0)})),fancyBar.selectAll("text.myLabel").attr("x",fancyXScale("Recorded Crimes")+fancyXScale.bandwidth()/2).transition().attr("y",textHeight-5).style("text-anchor","middle").text(numberWithCommas(total))}function barPosition(crimeForTract,offsetHeight,d){index=crimeForTract.indexOf(d);var thisheight=0,val=crimeForTract[0];if(1==index)thisheight=offsetHeight-fancyYScale(d.Count);else if(2==index){var valOne=crimeForTract[1],prevheight;thisheight=offsetHeight-fancyYScale(valOne.Count)+offsetHeight-fancyYScale(d.Count)}return fancyYScale(val.Count)-thisheight}var pie=d3.pie().value((function(d){return d.value})).sort(null),piePath=d3.arc().outerRadius(.9*pieRadius).innerRadius(.5*pieRadius),pieLabel=d3.arc().outerRadius(pieRadius).innerRadius(.5*pieRadius),pieChartColors=["#154360","#17a589","#56C3F2","#5663F2","#7fb3d5","#8FA75A","#BCFD8E","#676767"],pieChartLabels=["White","Black","Indigenous","Asian","Islander","Other","Latino","Unknown"],pieG=pieChart.append("g").attr("transform","translate("+500/3+","+300/2.85+")");function pointIsInArc(pt,ptData,d3Arc){var r1=d3Arc.innerRadius()(ptData),r2=d3Arc.outerRadius()(ptData),theta1=d3Arc.startAngle()(ptData),theta2=d3Arc.endAngle()(ptData),dist=pt.x*pt.x+pt.y*pt.y,angle=Math.atan2(pt.x,-pt.y);return angle=angle<0?angle+2*Math.PI:angle,r1*r1<=dist&&dist<=r2*r2&&theta1<=angle&&angle<=theta2}pieG.append("g").append("text").attr("class","racePercentage").style("font-size","16px").style("text-anchor","middle").attr("transform",`translate(0, ${.015*plotHeight})`);const pieChartColorScale=d3.scaleOrdinal().domain(pieChartLabels).range(pieChartColors);var raceDist=[{index:0,label:"White",value:0},{index:1,label:"Black",value:0},{index:2,label:"Indigenous",value:0},{index:3,label:"Asian",value:0},{index:4,label:"Islander",value:0},{index:5,label:"Other",value:0},{index:6,label:"Latino",value:0},{index:7,label:"Unknown",value:0}],selmodel=SelectionModel();function createPieChart(tractNum){data=tractToRacePercentages.get(tractNum);for(let i=0;i<raceDist.length;i++)raceDist[i].value=data[i];pieG.selectAll("path").data(pie(raceDist),(function(d){return d.data.label})).join((function(enter){enter.append("path").attr("fill",(function(d){return selmodel.has(d.data.index)?pieChartColorScale(d.data.label):"#ccc"})).attr("d",piePath).attr("stroke","white").each((function(d){this._current=d})).on("mousemove",(function(event,d){d3.select(this).raise().style("stroke","#d5ab09").style("stroke-width",4),pieG.selectAll(".racePercentage").text(parseFloat(tractToRacePercentages.get(currentSelectedTract)[d.index]).toFixed(1)+"%")})).on("mouseleave",(function(event,d){d3.select(this).raise().style("stroke","white").style("stroke-width",1),pieG.selectAll(".racePercentage").text(null)}))}),(function(update){update.attr("fill",(function(d){return selmodel.has(d.data.index)?pieChartColorScale(d.data.label):"#ccc"})).attr("stroke","white").call(update=>update.transition().attrTween("d",arcTween))}),(function(exit){exit.remove()})),selmodel.on("change.chart",()=>{pieG.selectAll("path").attr("fill",d=>selmodel.has(d.data.index)?pieChartColorScale(d.data.label):"#ccc")})}function arcTween(a){var i=d3.interpolate(this._current,a);return this._current=i(0),function(t){return piePath(i(t))}}function createPieLegend(){const titlePadding=14,entrySpacing=16,entryRadius=5,labelOffset=6,baselineOffset=4,positionYOffset=7,pieLegend=pieChart.append("g").attr("transform","translate(325, 15)"),title=pieLegend.append("text").attr("x",0).attr("y",7).attr("fill","black").attr("font-weight","bold").attr("font-size","20px").text("Race"),entries=pieLegend.selectAll("g").data(raceDist).join("g").attr("transform",d=>`translate(0, ${14+16*d.index})`),symbols=entries.append("circle").attr("cx",5).attr("cy",7).attr("r",5).attr("fill",d=>pieChartColorScale(d.index)),labels=entries.append("text").attr("x",16).attr("y",11).attr("fill","black").attr("font-size","14px").style("user-select","none").text(d=>d.label)}var scatterLabels=["Median Income White","Median Income Asian","Median Income Latino","Median Income Other","Median Income Black"],plotXScale,plotYScale,plotXAxis,plotYAxis;function drawPlot(){var data=[],defaultNum=0,seattleData=[];incomeData.forEach((function(entry){for(var i=0;i<scatterLabels.length;i++){var label=scatterLabels[i],income=parseInt(entry[label]);income>0&&(data.push({x:label,y:income,t:entry.Tract}),0==entry.Tract&&seattleData.push({x:label,y:income,t:entry.Tract}))}})),plotXScale=d3.scaleBand().range([0,plotWidth]).padding(.4).domain(scatterLabels),plotYScale=d3.scaleLinear().domain([0,26e4]).range([plotHeight,0]),plotXAxis=plotG.append("g").attr("transform","translate(0,"+plotHeight+")").call(d3.axisBottom(plotXScale)).selectAll("text").style("text-anchor","start").attr("dx","-12em").attr("dy","2em").style("font-size","14px").attr("transform","rotate(-45)"),plotYAxis=plotG.append("g").call(d3.axisLeft(plotYScale)),plotG.selectAll(".bar").data(seattleData).enter().append("rect").style("fill","silver").attr("x",(function(d){return plotXScale(d.x)+plotXScale.bandwidth()/2-20})).attr("width",40).attr("y",(function(d){return plotYScale(d.y)})).attr("height",2),plotG.selectAll(".dot").data(data).enter().append("circle").attr("class","dot").attr("cx",(function(d){return plotXScale(d.x)+plotXScale.bandwidth()/2})).attr("cy",(function(d){return plotYScale(d.y)})).attr("r",3).attr("tractNum",(function(d){return d.t})).style("fill",(function(d){return"Median Income White"==d.x?"#154360":"Median Income Asian"==d.x?"#5663F2":"Median Income Black"==d.x?"#17a589":"Median Income Other"==d.x?"#8FA75A":"#BCFD8E"})),plotG.append("g").append("text").attr("class","medianIncome").style("font-size","16px").attr("transform",`translate(${.35*plotWidth}, ${.05*plotHeight})`)}function tooltipTitle(t){return 0==t?"City of Seattle":"Census Tract "+(t/=100)}function createMapping(crimeData,quantiledValue){let sortable=[],tempMap=new Map;for(let i=0;i<crimeData.length;i++){let entry=crimeData[i];if("0"!=entry.Tract)if(tempMap.has(entry.GEO_ID)){let index,sortableEntry;sortable[tempMap.get(entry.GEO_ID)][quantiledValue]+=parseInt(entry[quantiledValue])}else{let index=sortable.length;tempMap.set(entry.GEO_ID,index);let sortableEntry=new Object;sortableEntry[quantiledValue]=parseInt(entry[quantiledValue]),sortableEntry.Tract=entry.Tract,sortableEntry.GEO_ID=entry.GEO_ID,sortable.push(sortableEntry)}}sortable=removeItemAll(sortable,-1,quantiledValue),sortable.sort((function(a,b){return a[quantiledValue]-b[quantiledValue]}));let mapping=new Map;for(let i=0;i<sortable.length;i++)mapping.set(parseInt(sortable[i].Tract),i);return mapping}function SelectionModel(values){const dispatch=d3.dispatch("change"),state=new Set(values),api={on:(type,fn)=>(dispatch.on(type,fn),api),clear:()=>(clear(),api),has:value=>!state.size||state.has(value),set:value=>(update(value,!0),api),toggle:value=>(update(value,!state.has(value)),api)};function clear(){state.size&&(state.clear(),dispatch.call("change",api,api))}function update(value,add){add&&!state.has(value)?(state.add(value),dispatch.call("change",api,api)):!add&&state.has(value)&&(state.delete(value),dispatch.call("change",api,api))}return api}function numberWithCommas(x){return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}const ID_DOWNTOWN="8100",ID_MONTLAKE="6200",ID_BRIARCLIFF="5600",ID_LAURELHURST="4100",ID_BROADVIEW="500",ID_NORTHGATE="1200",ID_BALLARD="4700",ID_COLUMBIA="10100",ID_BEACON_HILL="9400",ID_INTERNATIONAL="9100",ID_RAINIER="11800",container=d3.select("#scrolly-overlay"),stepSel=container.selectAll(".step");function resetMouseovers(){plotG.selectAll(".dot").style("stroke",null),pieG.selectAll("path").style("stroke","white").style("stroke-width",1),pieG.selectAll(".racePercentage").text(null),d3.selectAll(".tooltip").classed("hidden",!0),fancyBar.selectAll("rect").style("stroke",null),tractMap.selectAll("path").style("stroke","#A9A9A9").style("stroke-width",1)}function updateCharts(index){0!=index&&(1==index?(tractEl=document.getElementById("8100"),resetMouseovers(),eventFire(tractEl,"click")):2==index?(tractEl=document.getElementById("6200"),resetMouseovers(),eventFire(tractEl,"click")):3==index?(tractEl=document.getElementById("5600"),resetMouseovers(),eventFire(tractEl,"click")):4==index?(tractEl=document.getElementById("4100"),resetMouseovers(),eventFire(tractEl,"click")):5==index?(tractEl=document.getElementById("500"),resetMouseovers(),eventFire(tractEl,"click")):6==index?(tractEl=document.getElementById("1200"),resetMouseovers(),eventFire(tractEl,"click")):7==index?(tractEl=document.getElementById("4700"),resetMouseovers(),eventFire(tractEl,"click")):8==index?(tractEl=document.getElementById("10100"),resetMouseovers(),eventFire(tractEl,"click")):9==index?(tractEl=document.getElementById("9400"),resetMouseovers(),eventFire(tractEl,"click")):10==index?(tractEl=document.getElementById("9100"),resetMouseovers(),eventFire(tractEl,"click")):11==index&&(tractEl=document.getElementById("11800"),resetMouseovers(),eventFire(tractEl,"click")))}function exitCharts(){selected&&(tractEl=document.getElementById("8100"),eventFire(tractEl,"click"),eventFire(tractEl,"mouseleave"))}function eventFire(el,etype){if(null!=el)if(el.fireEvent)el.fireEvent("on"+etype);else{var evObj=document.createEvent("Events");evObj.initEvent(etype,!0,!1),el.dispatchEvent(evObj)}}function removeItemAll(arr,value,quantiledValue){for(var i=0;i<arr.length;)arr[i][quantiledValue]===value?arr.splice(i,1):++i;return arr}function handleResize(){d3.select("#dashboard").select(".dashSvg").style("width",window.innerWidth-20+"px"),d3.select("#dashboard").select(".dashSvg").style("height",window.innerHeight-20+"px")}enterView({selector:stepSel.nodes(),offset:.5,enter:el=>{const index=+d3.select(el).attr("data-index");updateCharts(index,"enter")},exit:el=>{let index=+d3.select(el).attr("data-index");0==index?exitCharts():updateCharts(index-1)}}),handleResize(),window.addEventListener("resize",handleResize);